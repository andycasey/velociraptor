random_seed: 42

data_path: data/gaia-sources-for-npm-colsubset.fits
data_hdu: 1
results_path: results/velociraptor-catalog.rc.7.fits
metadata_path: results/velociraptor-catalog.rc.7.meta
overwrite_results: false

# This is the number of sources to fit in the non-parametric model and the
# gaussian process. This should be set by "what you can afford" by the gaussian
# process.
number_of_sources_to_fit: 10000
# Strategy to select sources can be: random, subsample-equispaced-grid,
#                                    subsample-equidensity-grid
strategy_to_select_sources: subsample-equispaced-grid

# These settings are only applicable to the subsampling strategies.
minimum_points_in_grid_bin: 100
select_sources_opt_kwds:
  a: 10
  b: 250
  xtol: 0.1

subsample_label_names:
  - bp_rp
  - absolute_g_mag
  - phot_g_mean_mag

suitable_source_constraints:
  astrometric_unit_weight_error: [0, 10]
  rv_nb_transits: [5, 1000]

# These are the settings for the non-parametric models you want to run.
non_parametric_models:
  radial_velocity:
      descriptive_prefix: rv
      predictor_label_names:
        - rv_single_epoch_scatter
      kdtree_label_names:
        - bp_rp
        - absolute_rp_mag
        - phot_rp_mean_mag
      kdtree_minimum_points: 128
      kdtree_maximum_points: 1024
      kdtree_relative_scales: [0.05, 0.50, 0.25]
      kdtree_minimum_radius: [0.10, 0.50, 0.50]
      kdtree_maximum_radius: [0.25, 2.5, 1.5]

      assign_optimised_result_to_nearest: 0
      use_optimised_result_as_initialisation_for_nearest: 0

      model_path: npm-1d-rv.stan

      optimisation_kwds:
        verbose: false
        iter: 10000

      initialisation:
        theta: 0.75
        mu_single: 1
        sigma_single: 0.5
        mu_multiple: 1
        sigma_multiple: 0.75

      parameter_bounds:
        theta: [0, 1]
        mu_single: [0.5, 15]
        sigma_single: [0.05, 10]
        sigma_multiple: [0.20, 5]

      # This will run in serial mode if multiprocessing_threads is 0 or 1.
      # If set to a negative number, then the number of cores will be set by the
      # number of cores available.
      multiprocessing_threads: -1
      gp_chunk_size: 10000

  astrometry:
    descriptive_prefix: ast
    predictor_label_names:
      - astrometric_unit_weight_error
    kdtree_label_names:
      - bp_rp
      - phot_g_mean_mag
      - absolute_g_mag
    kdtree_minimum_points: 128
    kdtree_maximum_points: 1024
    kdtree_relative_scales: [0.05, 0.50, 0.25]
    kdtree_minimum_radius: [0.10, 0.50, 0.50]
    kdtree_maximum_radius: [0.25, 2.5, 1.5]

    assign_optimised_result_to_nearest: 0
    use_optimised_result_as_initialisation_for_nearest: 0

    optimisation_kwds:
      verbose: false
      iter: 10000

    model_path: npm-1d-rv.stan

    initialisation:
      theta: 0.75
      mu_single: 1
      sigma_single: 0.5
      mu_multiple: 1
      sigma_multiple: 0.75

    parameter_bounds:
      theta: [0, 1]
      mu_single: [0.5, 10]
      sigma_single: [0, 10]
      sigma_multiple: [0, 10]

    # This will run in serial mode if multiprocessing_threads is 0 or 1.
    # If set to a negative number, then the number of cores will be set by the
    # number of cores available.
    multiprocessing_threads: -1
    gp_chunk_size: 10000

gp_use_hodlr: true

#TODO: parameterise what sensible options we can/should here (eg kernels?)
#gaussian_process_models:
